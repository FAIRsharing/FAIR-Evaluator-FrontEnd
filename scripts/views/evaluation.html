<div warning></div>

<div class="container mainContainer fade show" ng-if="response_rdy && request_error">
    <div timeout></div>
</div>

<div class="container mainContainer fade show" ng-if="response_rdy && !request_error" id="evaluation">

    <div class="container evalTitle">

        <div class="row evaluationTitle">
            <div class="col-11"><h2>{{evaluation.title}}</h2></div>
            <div class="orcid_logo col-1">
                <a href="{{evaluation['creator']}}" target="_blank" class="orcidLink">
                    <img src="assets/img/orcid.png" class="orcid_icon">
                </a>
            </div>
        </div>

        <div class="row" ng-controller="graphCtrl as Graph">

            <div class="col-8 container">
                <div class="row evaluationDescriptionContainer">
                    <div class="col-12 evaluationDescription">

                        <h6> Summary: </h6>

                        <!-- Description -->
                        <div class="evaluationDescriptionItem">
                            <label>Description: </label>
                            <span> {{evaluation["http://rdfs.org/ns/void#description"]}}</span>
                        </div>

                        <!-- Resource -->
                        <div class="evaluationDescriptionItem">
                            <label>Resource: </label>
                            <a ng-href="https://doi.org/{{evaluation['primaryTopic']}}" target="_blank">
                                {{evaluation['primaryTopic']}}
                            </a>
                        </div>

                        <!-- Tested Against -->
                        <div class="evaluationDescriptionItem">
                            <label> Collection: </label>
                            <a href="{{evaluation['collection']}}"> {{evaluation["collection"] | URL_last_arg}} </a>
                        </div>

                        <!-- Tests -->
                        <div class="evaluationDescriptionItem">
                            <label> Observations: </label>
                            <span> Ran {{evaluation['evaluationResult'] | length}} tests ({{pie_data[0]}} succeeded, {{pie_data[1]}} failed).</span>
                        </div>


                    </div>
                </div>

            </div>

            <div class="col-4">
                <div class="doughnut">
                    <div class="container">
                        <div class="row">
                            <h6>Tests passing and failing </h6>
                        </div>
                        <div class="row">
                            <canvas id="doughnut"
                                    class="chart chart-doughnut row"
                                    chart-data="pie_data"
                                    chart-labels="pie_labels"
                                    width=110>
                            </canvas>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>

    <div class="">
        <div class="container">

            <div class="row" id="verticalSlider">
                <div class="col-12 card"
                     ng-repeat="(resultKey, resultVal) in evaluation['evaluationResult']"
                     ng-class="{'border-warning': resultVal[1]['deprecated'] == true}">

                    <div class="card-header " id="header_{{$index}}">

                    <button class="btn btn-link btnBlock" data-toggle="collapse" data-target="#collapse_{{$index}}" aria-expanded="false" aria-controls="collapse_{{$index}}">
                        <i class="fa"
                           ng-class="{'fa-check': resultVal[0]['http://semanticscience.org/resource/SIO_000300'][0]['@value'] == 1, 'fa-times': resultVal[0]['http://semanticscience.org/resource/SIO_000300'][0]['@value'] == 0}">
                        </i>
                        {{resultVal[1]["name"]}}
                        <!--
                        <div class="openButton">
                            <i class="fa fa-chevron-right" id="open_{{$index}}">
                            </i>
                        </div>
                        -->
                    </button>

                    </div>

                    <div id="collapse_{{$index}}"
                         class="collapse"
                         ng-class="{'show': $first}"
                         aria-labelledby="heading_{{index}}"
                         data-parent="#verticalSlider">
                        <div class="card-body">

                            <div class="metricField">
                                <label>Status: </label>
                                <span ng-if="resultVal[0]['http://semanticscience.org/resource/SIO_000300'][0]['@value'] == 1">Success
                                </span>
                                <span ng-if="resultVal[0]['http://semanticscience.org/resource/SIO_000300'][0]['@value'] == 0">Failure
                                </span>
                            </div>

                            <div class="metricField">
                                <label>Principle tested: </label>
                                <span>{{resultVal[1]['principle'] | URL_last_arg}}</span>
                            </div>

                            <div class="metricField">
                                <label>Description: </label>
                                <span>{{resultVal[1]['description']}}</span>
                            </div>

                            <div class="metricField">
                                <label>Created on: </label>
                                <span>
                                    {{resultVal[1]['created_at'] | date}} by
                                    <a href="https://orcid.org/{{resultVal[1]['orcid']}}" target="_blank">{{resultVal[1]['creator']}}</a>
                                    (updated on {{resultVal[1]['updated_at'] | date}}).
                                </span>
                            </div>

                            <div class="metricField testResult">
                                <label class="resultLabel">Test results</label>
                                <div class="terminal newlines" ng-bind-html='resultVal[0]["http://schema.org/comment"][0]["@value"]'></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="goBack">
        <a ng-href="#!/evaluations">
        <button type="button"
                class="btn-primary btn">
            Go Back to Evaluations
        </button>
        </a>
    </div>
</div>

<!-- waiter -->
<div class="container fade show" ng-if="!response_rdy">
    <div loader></div>
</div>

